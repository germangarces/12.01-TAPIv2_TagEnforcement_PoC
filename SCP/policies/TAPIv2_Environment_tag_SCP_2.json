{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "TAPIv2DenyResourceCreationWithoutEnvironmentTypeTag2",
      "Effect": "Deny",
      "Action": [
        "ec2:CreateClientVpnEndpoint",
        "ec2:CreateCustomerGateway",
        "ec2:CreateEgressOnlyInternetGateway",
        "ec2:CreateFlowLogs",
        "ec2:CreateManagedPrefixList",
        "ec2:CreateNatGateway",
        "ec2:CreateNetworkInterface",
        "ec2:CreateSnapshot",
        "ec2:CreateVpcEndpoint",
        "ec2:CreateVpcEndpointServiceConfiguration",
        "ec2:CreateVpcPeeringConnection",
        "ec2:CreateVpnGateway",
        "ecs:CreateCluster",
        "ecs:RegisterTaskDefinition",
        "eks:CreateCluster",
        "elasticache:CreateCacheCluster",
        "elasticbeanstalk:CreateApplication",
        "elasticfilesystem:CreateFileSystem",
        "elasticloadbalancing:CreateLoadBalancer",
        "es:CreateDomain",
        "events:CreateEventBus",
        "firehose:CreateDeliveryStream",
        "fsx:CreateFileCache",
        "fsx:CreateFileSystem",
        "glacier:CreateVault",
        "glue:CreateCrawler",
        "glue:CreateJob",
        "kinesis:CreateStream",
        "kinesisvideo:CreateStream",
        "kms:CreateKey",
        "lambda:CreateFunction",
        "logs:CreateLogGroup",
        "mediaconvert:CreateQueue",
        "mq:CreateBroker",
        "mq:CreateConfiguration"
      ],
      "Resource": [
        "arn:aws:ec2:*:*:client-vpn-endpoint/*",
        "arn:aws:ec2:*:*:customer-gateway/*",
        "arn:aws:ec2:*:*:egress-only-internet-gateway/*",
        "arn:aws:ec2:*:*:natgateway/*",
        "arn:aws:ec2:*:*:network-interface/*",
        "arn:aws:ec2:*:*:prefix-list/*",
        "arn:aws:ec2:*:*:snapshot/*",
        "arn:aws:ec2:*:*:vpc-endpoint-service/*",
        "arn:aws:ec2:*:*:vpc-endpoint/*",
        "arn:aws:ec2:*:*:vpc-flow-log/*",
        "arn:aws:ec2:*:*:vpc-peering-connection/*",
        "arn:aws:ec2:*:*:vpn-gateway/*",
        "arn:aws:ecs:*:*:cluster/*",
        "arn:aws:ecs:*:*:task-definition/*",
        "arn:aws:eks:*:*:cluster/*",
        "arn:aws:elasticache:*:*:cluster/*",
        "arn:aws:elasticbeanstalk:*:*:application/*",
        "arn:aws:elasticfilesystem:*:*:file-system/*",
        "arn:aws:elasticloadbalancing:*:*:loadbalancer/*",
        "arn:aws:es:*:*:domain/*",
        "arn:aws:events:*:*:event-bus/*",
        "arn:aws:firehose:*:*:deliverystream/*",
        "arn:aws:fsx:*:*:file-cache/*",
        "arn:aws:fsx:*:*:file-system/*",
        "arn:aws:glacier:*:*:vaults/*",
        "arn:aws:glue:*:*:crawler/*",
        "arn:aws:glue:*:*:job/*",
        "arn:aws:kinesis:*:*:stream/*",
        "arn:aws:kinesisvideo:*:*:stream/*",
        "arn:aws:kms:*:*:key/*",
        "arn:aws:lambda:*:*:function:*",
        "arn:aws:logs:*:*:log-group:*",
        "arn:aws:mediaconvert:*:*:queues/*",
        "arn:aws:mq:*:*:broker/*",
        "arn:aws:mq:*:*:configuration/*"
      ],
      "Condition": {
        "Null": {
          "aws:RequestTag/Environment": "true"
        }
      }
    }
  ]
}