{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "TAPIv2DenyResourceCreationWithoutEnvironmentTypeTag1",
      "Effect": "Deny",
      "Action": [
        "acm:RequestCertificate",
        "apprunner:CreateService",
        "apprunner:CreateVpcConnector",
        "appsync:CreateGraphqlApi",
        "athena:CreateWorkGroup",
        "autoscaling:CreateAutoScalingGroup",
        "backup:CreateBackupPlan",
        "backup:CreateBackupVault",
        "batch:CreateComputeEnvironment",
        "batch:RegisterJobDefinition",
        "cloudformation:CreateStack",
        "cloudtrail:CreateTrail",
        "cloudwatch:PutMetricAlarm",
        "cognito-identity:CreateIdentityPool",
        "cognito-idp:CreateUserPool",
        "comprehend:CreateDocumentClassifier",
        "comprehend:CreateEntityRecognizer",
        "comprehend:CreateFlywheel",
        "datasync:CreateTask",
        "docdb-elastic:CreateCluster",
        "dynamodb:CreateTable",
        "ec2:RunInstances",
        "rds:CreateDBCluster",
        "rds:CreateDBClusterSnapshot",
        "rds:CreateDBInstance",
        "rds:CreateDBSnapshot",
        "redshift:CreateCluster",
        "rekognition:CreateStreamProcessor",
        "route53:CreateHealthCheck",
        "route53:CreateHostedZone",
        "s3:CreateBucket",
        "sagemaker:CreateModel",
        "sagemaker:CreateNotebookInstance",
        "secretsmanager:CreateSecret",
        "sqs:CreateQueue",
        "sns:CreateTopic",
        "states:CreateStateMachine",
        "waf:CreateWebACL",
        "workspaces:CreateWorkspaces"
      ],
      "Resource": [
        "arn:aws:acm:*:*:certificate/*",
        "arn:aws:apprunner:*:*:service/*",
        "arn:aws:apprunner:*:*:vpcconnector/*",
        "arn:aws:appsync:*:*:apis/*",
        "arn:aws:athena:*:*:workgroup/*",
        "arn:aws:autoscaling:*:*:autoScalingGroup:*:autoScalingGroupName/*",
        "arn:aws:backup:*:*:backup-plan:*:rule/*",
        "arn:aws:backup:*:*:backup-vault/*",
        "arn:aws:batch:*:*:compute-environment/*",
        "arn:aws:batch:*:*:job-definition/*",
        "arn:aws:cloudformation:*:*:stack/*/*",
        "arn:aws:cloudtrail:*:*:trail/*",
        "arn:aws:cloudwatch:*:*:alarm/*",
        "arn:aws:cognito-identity:*:*:identitypool/*",
        "arn:aws:cognito-idp:*:*:userpool/*",
        "arn:aws:comprehend:*:*:document-classifier/*",
        "arn:aws:comprehend:*:*:entity-recognizer/*",
        "arn:aws:comprehend:*:*:flywheel/*",
        "arn:aws:datasync:*:*:task/*",
        "arn:aws:docdb-elastic:*:*:cluster/*",
        "arn:aws:dynamodb:*:*:table/*",
        "arn:aws:ec2:*:*:instance/*",
        "arn:aws:rds:*:*:cluster-snapshot/*",
        "arn:aws:rds:*:*:cluster/*",
        "arn:aws:rds:*:*:db/*",
        "arn:aws:rds:*:*:snapshot/*",
        "arn:aws:redshift:*:*:cluster/*",
        "arn:aws:rekognition:*:*:streamprocessor/*",
        "arn:aws:route53:::healthcheck/*",
        "arn:aws:route53:::hostedzone/*",
        "arn:aws:s3:::*3",
        "arn:aws:sagemaker:*:*:model/*",
        "arn:aws:sagemaker:*:*:notebook-instance/*",
        "arn:aws:secretsmanager:*:*:secret:*",
        "arn:aws:sns:*:*:*",
        "arn:aws:sqs:*:*:*",
        "arn:aws:states:*:*:stateMachine:*",
        "arn:aws:waf::*:webacl/*",
        "arn:aws:workspaces:*:*:workspace/*"
      ],
      "Condition": {
        "Null": {
          "aws:RequestTag/Environment": "true"
        }
      }
    }
  ]
}